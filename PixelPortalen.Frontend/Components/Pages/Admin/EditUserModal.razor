@using PixelPortalen.Shared.Models
@using Microsoft.AspNetCore.Components
@using Microsoft.AspNetCore.Components.Forms

@if (Visible && User != null)
{
    <div class="modal fade show" style="display:block;" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Redigera @User.FirstName @User.LastName</h5>
                    <button type="button" class="btn-close" @onclick="OnCancel"></button>
                </div>

                <EditForm Model="User" OnValidSubmit="HandleValidSubmit">
                    <DataAnnotationsValidator />
                    <ValidationSummary />

                    <div class="modal-body">
                        <div class="mb-3">
                            <label class="form-label">Förnamn</label>
                            <InputText class="form-control" @bind-Value="User.FirstName" />
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Efternamn</label>
                            <InputText class="form-control" @bind-Value="User.LastName" />
                        </div>
                        <div class="mb-3">
                            <label class="form-label">E-post</label>
                            <InputText class="form-control" @bind-Value="User.Email" />
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Telefon</label>
                            <InputText class="form-control" @bind-Value="User.PhoneNumber" />
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Land</label>
                            <InputText class="form-control" @bind-Value="User.Address.Country" />
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Stad</label>
                            <InputText class="form-control" @bind-Value="User.Address.City" />
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Adress</label>
                            <InputText class="form-control" @bind-Value="User.Address.Address" />
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Postnummer</label>
                            <InputText class="form-control" @bind-Value="User.Address.PostalCode" />
                        </div>
                    </div>

                    <div class="modal-footer">
                        <button id="CancelBTN" type="button" class="btn btn-secondary" @onclick="OnCancel">Avbryt</button>
                        <button id="SaveBTN" type="submit" class="btn btn-primary">Spara</button>
                    </div>
                </EditForm>
            </div>
        </div>
    </div>
    <div class="modal-backdrop fade show"></div>
}

@code {
    [Parameter] public Customer User { get; set; }
    [Parameter] public bool Visible { get; set; }
    [Parameter] public EventCallback<Customer> OnSave { get; set; }
    [Parameter] public EventCallback OnCancel { get; set; }

    private async Task HandleValidSubmit()
    {
        await OnSave.InvokeAsync(User);
    }
}
